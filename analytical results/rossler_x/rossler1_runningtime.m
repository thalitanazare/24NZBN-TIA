clear all
clc
close all

num_iter = 50;
normal_time = zeros(1, num_iter);
horner_time = zeros(1, num_iter);

for iter = 1:num_iter

    %normal method
tic
format long

x=[0.1000057140259469; 0.10000428889054676; 0.10000578091301135; 0.1000020609823214; 0.10000813321251358];

N=6000;
for i=6:N
x(i)=0.1972*10*x(i-1) - 0.104*10*x(i-2) ...
                  + 0.7456e-4*x(i-4)*x(i-2)^3*x(i-1) ...
                  - 0.2053e-4*x(i-5)*x(i-4)^4 ...
                  - 0.285e-4*x(i-5)*x(i-1)^4 ...
                  + 0.2484e-4*x(i-3)^2*x(i-2)^3 ...
                  + 0.1238e-2*x(i-2)*x(i-1)^2 ...
                  + 0.4353e-4*x(i-5)^4 ...
                  + 0.2258e-2*x(i-5)*x(i-2)*x(i-1)^2 ...
                  + 0.3123e-4*x(i-4)^5 ...
                  + 0.7531e-3*x(i-1)^4 ...
                  - 0.2703e-2*x(i-3)^2*x(i-1)^2 ...
                  - 0.7807e-3*x(i-1)^3 ...
                  - 0.7077e-4*x(i-3)^2*x(i-2)^2*x(i-1) ...
                  - 0.3304e-3*x(i-3)*x(i-2)^3 ...
                  - 0.8847e-2*x(i-5)*x(i-1) ...
                  + 0.7631e-2*x(i-4)*x(i-1) ...
                  - 0.3870e-4*x(i-5)^3*x(i-1)^2 ...
                  + 0.4676e-3*x(i-3)^3*x(i-1);
end
normal_time(iter) = toc;

% 
% plot(x,'k')
% hold on
% 
% filex = fopen('rossler_normal.txt','w');
% fprintf(filex,'%12.15f\n',x);
% fclose(filex);

tic
format long

x2=[0.1000057140259469; 0.10000428889054676; 0.10000578091301135; 0.1000020609823214; 0.10000813321251358];

N=6000;
for i=6:N
x2(i)= - 0.104*10*x2(i-2) - 0.2053e-4*x2(i-5)*x2(i-4)^4 ...
                  + 0.2484e-4*x2(i-3)^2*x2(i-2)^3 ...
                  + 0.4353e-4*x2(i-5)^4   ...
                  + 0.3123e-4*x2(i-4)^5  ...
                  - 0.3304e-3*x2(i-3)*x2(i-2)^3 ...
                  + x2(i-1) * (0.1972*10 ...
                  + 0.7456e-4*x2(i-4)*x2(i-2)^3 ...
                  - 0.7077e-4*x2(i-3)^2*x2(i-2)^2 ...
                  - 0.8847e-2*x2(i-5) ...
                  + 0.7631e-2*x2(i-4) ...
                  + 0.4676e-3*x2(i-3)^3 ...
                  + x2(i-1) * (0.1238e-2*x2(i-2) ...
                  + 0.2258e-2*x2(i-5)*x2(i-2) ...
                  - 0.2703e-2*x2(i-3)^2 ...
                  - 0.3870e-4*x2(i-5)^3 ...
                  + x2(i-1) * (-0.7807e-3 ...
                  + x2(i-1) * (- 0.285e-4*x2(i-5) + 0.7531e-3))));

end
horner_time(iter) = toc;
end

 % Calculate mean and standard deviation
normal_mean = mean(normal_time);
normal_std = std(normal_time);
horner_mean = mean(horner_time);
horner_std = std(horner_time);

% Display results
fprintf('Normal method: \n');
fprintf('Mean time: %.15f\n', normal_mean);
fprintf('Standard deviation: %.15f\n', normal_std);
fprintf('\n');
fprintf('Horner''s method: \n');
fprintf('Mean time: %.15f\n', horner_mean);
fprintf('Standard deviation: %.15f\n', horner_std);

% 
% plot(x,'k')
% hold on
% 
% filex2 = fopen('rossler_horner.txt','w');
% fprintf(filex2,'%12.15f\n',x);
% fclose(filex2);